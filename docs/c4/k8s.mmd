%%{init: {'theme': 'neutral'}}%%
C4Container
title Kubernetes deployment (Catalog + Excalidraw)

Person(user, "User", "Edits and exports diagrams")
System_Ext(s3, "S3", "Markup JSON storage")

System_Boundary(k8s, "Kubernetes cluster") {
  Container(ingress, "Ingress", "NGINX/ALB", "Routes traffic")
  Container(catalog, "Catalog UI", "FastAPI", "Catalog list, API, Excalidraw proxy")
  Container(excalidraw, "Excalidraw UI", "excalidraw/excalidraw", "Diagram editor")
  ContainerDb(pv, "RWX PVC", "Shared storage", "excalidraw_in/out, roundtrip, index")
}

Rel(user, ingress, "Browse catalog", "HTTPS")
Rel(ingress, catalog, "Routes /", "HTTP")
Rel(catalog, excalidraw, "Proxy UI under /excalidraw", "HTTP")
Rel(catalog, s3, "Read markup", "S3 API")
Rel(catalog, pv, "Read/write scenes + roundtrip", "RWX volume")
